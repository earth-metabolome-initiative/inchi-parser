//!

use inchi_parser::{errors::Error, inchi::InChI};

const INCHI_TEST: &[&str] = &[
    "InChI=1S/C2H6O/c1-2-3/h3H,2H2,1H3",
    "InChI=1S/C6H8O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2,5,7-10H,1H2/t2-,5+/m0/s1",
    "InChI=1S/C16H25NS/c1-12(2)13-7-5-8-15(3)9-6-10-16(4,14(13)15)17-11-18/h13-14H,1,5-10H2,2-4H3/t13-,14-,15+,16-/m1/s1",
    "InChI=1S/C28H23ClO7/c1-11-5-19(33)24(29)27(36-4)20(11)15-8-13(30)6-12-7-16-23(25(34)21(12)15)26(35)22-17(28(16,2)3)9-14(31)10-18(22)32/h5-10,30-34H,1-4H3",
    "InChI=1S/C32H34N4O4.Ni/c1-6-18-14(2)23-11-27-21(13-37)16(4)22(34-27)10-24-15(3)19(7-8-29(39)40)31(35-24)20-9-28(38)30-17(5)25(36-32(20)30)12-26(18)33-23;/h10-12,15,19,37H,6-9,13H2,1-5H3,(H3,33,34,35,36,38,39,40);/q;+2/p-2/t15-,19-;/m0./s1",
    "InChI=1S/O/q-2",
    "InChI=1S/O",
    "InChI=1S/H2O/h1H2",
    "InChI=1S/H2O/h1H2/i/hD2",
    "InChI=1S/ClH.Na/h1H;/q;+1/p-1",
    // insuline
    "InChI=1S/C267H404N72O78S6/c1-29-137(23)212(330-199(355)109-269)260(412)334-211(136(21)22)256(408)305-166(79-86-206(365)366)226(378)298-163(75-82-196(273)352)230(382)326-190-122-421-422-123-191-251(403)322-185(117-341)249(401)312-170(94-129(7)8)234(386)313-176(101-146-57-65-152(346)66-58-146)237(389)299-161(73-80-194(271)350)227(379)308-169(93-128(5)6)232(384)301-165(78-85-205(363)364)229(381)320-182(107-197(274)353)244(396)316-178(103-148-61-69-154(348)70-62-148)240(392)325-188(222(374)290-115-207(367)368)120-418-420-121-189(221(373)288-112-200(356)294-160(76-83-203(359)360)225(377)297-157(53-42-88-284-265(276)277)219(371)287-113-201(357)295-174(99-144-48-36-32-37-49-144)236(388)315-175(100-145-50-38-33-39-51-145)239(391)317-179(104-149-63-71-155(349)72-64-149)247(399)338-216(142(28)345)263(415)339-91-45-56-193(339)254(406)302-158(52-40-41-87-268)231(383)336-214(140(26)343)261(413)303-159(54-43-89-285-266(278)279)224(376)306-167(264(416)417)55-44-90-286-267(280)281)328-258(410)210(135(19)20)333-245(397)172(96-131(11)12)310-238(390)177(102-147-59-67-153(347)68-60-147)314-233(385)168(92-127(3)4)307-217(369)139(25)293-223(375)164(77-84-204(361)362)304-255(407)209(134(17)18)332-246(398)173(97-132(13)14)311-242(394)181(106-151-111-283-126-292-151)319-248(400)184(116-340)296-202(358)114-289-220(372)187(119-419-423-124-192(327-252(190)404)253(405)337-215(141(27)344)262(414)323-186(118-342)250(402)335-213(138(24)30-2)259(411)329-191)324-235(387)171(95-130(9)10)309-241(393)180(105-150-110-282-125-291-150)318-228(380)162(74-81-195(272)351)300-243(395)183(108-198(275)354)321-257(409)208(133(15)16)331-218(370)156(270)98-143-46-34-31-35-47-143/h31-39,46-51,57-72,110-111,125-142,156-193,208-216,340-349H,29-30,40-45,52-56,73-109,112-124,268-270H2,1-28H3,(H2,271,350)(H2,272,351)(H2,273,352)(H2,274,353)(H2,275,354)(H,282,291)(H,283,292)(H,287,371)(H,288,373)(H,289,372)(H,290,374)(H,293,375)(H,294,356)(H,295,357)(H,296,358)(H,297,377)(H,298,378)(H,299,389)(H,300,395)(H,301,384)(H,302,406)(H,303,413)(H,304,407)(H,305,408)(H,306,376)(H,307,369)(H,308,379)(H,309,393)(H,310,390)(H,311,394)(H,312,401)(H,313,386)(H,314,385)(H,315,388)(H,316,396)(H,317,391)(H,318,380)(H,319,400)(H,320,381)(H,321,409)(H,322,403)(H,323,414)(H,324,387)(H,325,392)(H,326,382)(H,327,404)(H,328,410)(H,329,411)(H,330,355)(H,331,370)(H,332,398)(H,333,397)(H,334,412)(H,335,402)(H,336,383)(H,337,405)(H,338,399)(H,359,360)(H,361,362)(H,363,364)(H,365,366)(H,367,368)(H,416,417)(H4,276,277,284)(H4,278,279,285)(H4,280,281,286)/t137-,138-,139-,140+,141+,142+,156-,157-,158-,159-,160-,161-,162-,163-,164-,165-,166-,167-,168-,169-,170-,171-,172-,173-,174-,175-,176-,177-,178-,179-,180-,181-,182-,183-,184-,185-,186-,187-,188-,189-,190-,191-,192-,193-,208-,209-,210-,211-,212-,213-,214-,215-,216-/m0/s1",
];

#[test]
fn test_inchi_parsing() {
    let mut unimplemented_errors: Vec<&'static str> = Vec::new();
    for &inchi_str in INCHI_TEST {
        match inchi_str.parse::<InChI>() {
            Ok(_) => {}
            Err(Error::UnimplementedFeature(msg)) => {
                unimplemented_errors.push(inchi_str);
                println!("Unimplemented feature for InChI: {}: {}", inchi_str, msg);
            }
            Err(e) => {
                panic!("Failed to parse InChI {}: {:?}", inchi_str, e);
            }
        }
    }
    if !unimplemented_errors.is_empty() {
        panic!(
            "{} InChI strings could not be parsed due to unimplemented features.",
            unimplemented_errors.len()
        );
    }
}
