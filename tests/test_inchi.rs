//!

use inchi_parser::{errors::Error, inchi::InChI};

const INCHI_TEST: &[&str] = &[
    "InChI=1S/C2H6O/c1-2-3/h3H,2H2,1H3",
    "InChI=1S/C6H8O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2,5,7-10H,1H2/t2-,5+/m0/s1",
    "InChI=1S/C16H25NS/c1-12(2)13-7-5-8-15(3)9-6-10-16(4,14(13)15)17-11-18/h13-14H,1,5-10H2,2-4H3/t13-,14-,15+,16-/m1/s1",
    "InChI=1S/C28H23ClO7/c1-11-5-19(33)24(29)27(36-4)20(11)15-8-13(30)6-12-7-16-23(25(34)21(12)15)26(35)22-17(28(16,2)3)9-14(31)10-18(22)32/h5-10,30-34H,1-4H3",
    "InChI=1S/C32H34N4O4.Ni/c1-6-18-14(2)23-11-27-21(13-37)16(4)22(34-27)10-24-15(3)19(7-8-29(39)40)31(35-24)20-9-28(38)30-17(5)25(36-32(20)30)12-26(18)33-23;/h10-12,15,19,37H,6-9,13H2,1-5H3,(H3,33,34,35,36,38,39,40);/q;+2/p-2/t15-,19-;/m0./s1",
    "InChI=1S/O/q-2",
    "InChI=1S/O",
    "InChI=1S/H2O/h1H2",
    "InChI=1S/H2O/h1H2/i/hD2",
    "InChI=1S/ClH.Na/h1H;/q;+1/p-1",
    // insuline
    "InChI=1S/C267H404N72O78S6/c1-29-137(23)212(330-199(355)109-269)260(412)334-211(136(21)22)256(408)305-166(79-86-206(365)366)226(378)298-163(75-82-196(273)352)230(382)326-190-122-421-422-123-191-251(403)322-185(117-341)249(401)312-170(94-129(7)8)234(386)313-176(101-146-57-65-152(346)66-58-146)237(389)299-161(73-80-194(271)350)227(379)308-169(93-128(5)6)232(384)301-165(78-85-205(363)364)229(381)320-182(107-197(274)353)244(396)316-178(103-148-61-69-154(348)70-62-148)240(392)325-188(222(374)290-115-207(367)368)120-418-420-121-189(221(373)288-112-200(356)294-160(76-83-203(359)360)225(377)297-157(53-42-88-284-265(276)277)219(371)287-113-201(357)295-174(99-144-48-36-32-37-49-144)236(388)315-175(100-145-50-38-33-39-51-145)239(391)317-179(104-149-63-71-155(349)72-64-149)247(399)338-216(142(28)345)263(415)339-91-45-56-193(339)254(406)302-158(52-40-41-87-268)231(383)336-214(140(26)343)261(413)303-159(54-43-89-285-266(278)279)224(376)306-167(264(416)417)55-44-90-286-267(280)281)328-258(410)210(135(19)20)333-245(397)172(96-131(11)12)310-238(390)177(102-147-59-67-153(347)68-60-147)314-233(385)168(92-127(3)4)307-217(369)139(25)293-223(375)164(77-84-204(361)362)304-255(407)209(134(17)18)332-246(398)173(97-132(13)14)311-242(394)181(106-151-111-283-126-292-151)319-248(400)184(116-340)296-202(358)114-289-220(372)187(119-419-423-124-192(327-252(190)404)253(405)337-215(141(27)344)262(414)323-186(118-342)250(402)335-213(138(24)30-2)259(411)329-191)324-235(387)171(95-130(9)10)309-241(393)180(105-150-110-282-125-291-150)318-228(380)162(74-81-195(272)351)300-243(395)183(108-198(275)354)321-257(409)208(133(15)16)331-218(370)156(270)98-143-46-34-31-35-47-143/h31-39,46-51,57-72,110-111,125-142,156-193,208-216,340-349H,29-30,40-45,52-56,73-109,112-124,268-270H2,1-28H3,(H2,271,350)(H2,272,351)(H2,273,352)(H2,274,353)(H2,275,354)(H,282,291)(H,283,292)(H,287,371)(H,288,373)(H,289,372)(H,290,374)(H,293,375)(H,294,356)(H,295,357)(H,296,358)(H,297,377)(H,298,378)(H,299,389)(H,300,395)(H,301,384)(H,302,406)(H,303,413)(H,304,407)(H,305,408)(H,306,376)(H,307,369)(H,308,379)(H,309,393)(H,310,390)(H,311,394)(H,312,401)(H,313,386)(H,314,385)(H,315,388)(H,316,396)(H,317,391)(H,318,380)(H,319,400)(H,320,381)(H,321,409)(H,322,403)(H,323,414)(H,324,387)(H,325,392)(H,326,382)(H,327,404)(H,328,410)(H,329,411)(H,330,355)(H,331,370)(H,332,398)(H,333,397)(H,334,412)(H,335,402)(H,336,383)(H,337,405)(H,338,399)(H,359,360)(H,361,362)(H,363,364)(H,365,366)(H,367,368)(H,416,417)(H4,276,277,284)(H4,278,279,285)(H4,280,281,286)/t137-,138-,139-,140+,141+,142+,156-,157-,158-,159-,160-,161-,162-,163-,164-,165-,166-,167-,168-,169-,170-,171-,172-,173-,174-,175-,176-,177-,178-,179-,180-,181-,182-,183-,184-,185-,186-,187-,188-,189-,190-,191-,192-,193-,208-,209-,210-,211-,212-,213-,214-,215-,216-/m0/s1",
    "InChI=1S/C31H43NO10/c1-32-13-28(14-38-2)17(33)11-18(39-3)30-16-12-29(36)25(42-27(35)15-9-7-6-8-10-15)19(16)31(37,24(34)26(29)41-5)20(23(30)32)21(40-4)22(28)30/h6-10,16-26,33-34,36-37H,11-14H2,1-5H3/t16-,17-,18+,19-,20+,21+,22-,23?,24+,25-,26+,28+,29-,30+,31-/m1/s1",
    "InChI=1S/C67H114O27/c1-10-13-15-16-17-18-21-24-28-33-45(71)88-58-53(79)55(92-67-61(94-63-51(77)49(75)48(74)43(35-68)86-63)60(90-62(80)36(4)37(5)69)56(41(9)84-67)87-44(70)30-12-3)40(8)82-65(58)91-54-39(7)83-66-59(52(54)78)89-46(72)34-29-25-22-19-20-23-27-32-42(31-26-14-11-2)85-64-57(93-66)50(76)47(73)38(6)81-64/h12,30,36-43,47-61,63-69,73-79H,10-11,13-29,31-35H2,1-9H3/b30-12+/t36?,37?,38-,39+,40+,41+,42?,43-,47-,48-,49+,50+,51-,52-,53-,54+,55+,56+,57-,58-,59-,60-,61-,63-,64+,65+,66-,67+/m1/s1",
    "InChI=1S/C37H66O7/c1-3-4-5-6-7-11-14-17-20-31(39)33-22-24-35(43-33)36-25-23-34(44-36)32(40)21-18-15-12-9-8-10-13-16-19-30(38)27-29-26-28(2)42-37(29)41/h26,28,30-36,38-40H,3-25,27H2,1-2H3/t28-,30-,31+,32+,33+,34+,35+,36+/m0/s1",
    "InChI=1S/C62H116O16S/c1-7-9-11-13-15-17-19-21-22-23-24-25-26-27-29-30-32-34-36-38-40-47(3)42-48(4)43-49(5)44-50(6)60(69)76-57-55(67)52(46-64)74-62(77-61-58(78-79(70,71)72)56(68)54(66)51(45-63)73-61)59(57)75-53(65)41-39-37-35-33-31-28-20-18-16-14-12-10-8-2/h44,47-49,51-52,54-59,61-64,66-68H,7-43,45-46H2,1-6H3,(H,70,71,72)/b50-44+/t47-,48-,49-,51+,52+,54+,55+,56-,57-,58+,59+,61+,62+/m0/s1",
    "InChI=1S/C34H47ClN10O7/c1-17(2)26-32(51)45-24(9-6-14-38-45)31(50)43-22(7-4-12-36-43)27(46)39-18(3)29(48)44-23(8-5-13-37-44)30(49)42-25(28(47)41-26)16-34(52)20-11-10-19(35)15-21(20)40-33(34)42/h10-11,15,17-18,22-26,33,36-38,40,52H,4-9,12-14,16H2,1-3H3,(H,39,46)(H,41,47)",
    "InChI=1S/C30H46O3/c1-19(8-7-9-20(2)25(32)33)21-12-14-28(6)23-11-10-22-26(3,4)24(31)13-15-29(22)18-30(23,29)17-16-27(21,28)5/h9,19,21-23H,7-8,10-18H2,1-6H3,(H,32,33)/b20-9+",
    "InChI=1S/C30H48O6/c1-16-9-10-30(25(35)36)12-11-28(5)18(22(30)17(16)2)7-8-21-26(3)13-20(33)24(34)27(4,15-31)23(26)19(32)14-29(21,28)6/h7,16-17,19-24,31-34H,8-15H2,1-6H3,(H,35,36)/t16?,17?,19?,20?,21-,22+,23-,24?,26-,27+,28-,29-,30+/m1/s1",
    "InChI=1S/C15H24/c1-10-7-8-15-11(2)5-6-12(9-13(10)15)14(15,3)4/h11-12H,5-9H2,1-4H3/t11-,12-,15+/m1/s1",
    "InChI=1S/C21H20N4OS/c1-25(2)10-8-14-18-17-13(12-5-3-4-6-15(12)23-18)7-9-22-19(17)20-21(14)27-11-16(26)24-20/h3-7,9,23H,8,10-11H2,1-2H3,(H,24,26)",
    "InChI=1S/C15H22O2/c1-10(2)13-9-14(16)12(4)7-5-6-11(3)8-15(13)17/h6,12H,5,7-9H2,1-4H3/b11-6-",
    "InChI=1S/C20H20O2/c1-2-3-4-5-6-7-8-13-18-14-9-10-15-19(18)16-11-12-17-20(21)22/h2-17H,1H3,(H,21,22)/b3-2+,5-4+,7-6+,13-8+,16-11+,17-12+",
    "InChI=1S/C31H43NO10/c1-16-24(42-15-20-30(4)12-7-11-29(2,3)19(30)10-13-31(20,5)40)17-14-32(18(27(36)37)8-9-21(33)34)26(35)22(17)23(28(38)39)25(16)41-6/h18-20,40H,7-15H2,1-6H3,(H,33,34)(H,36,37)(H,38,39)/t18?,19-,20+,30-,31+/m0/s1",
    "InChI=1S/C40H56O2/c1-29(17-13-19-31(3)21-23-37-33(5)25-35(41)27-39(37,7)8)15-11-12-16-30(2)18-14-20-32(4)22-24-38-34(6)26-36(42)28-40(38,9)10/h11-26,35-38,41-42H,27-28H2,1-10H3/b12-11+,17-13+,18-14+,23-21+,24-22+,29-15+,30-16+,31-19+,32-20+/t35-,36-,37-,38+/m0/s1",
    "InChI=1S/C15H24N2O/c18-15-6-3-5-14-11-8-12(10-17(14)15)13-4-1-2-7-16(13)9-11/h11-14H,1-10H2/t11-,12+,13-,14-/m1/s1",
    "InChI=1S/C41H32O27/c42-15-1-10(2-16(43)26(15)51)35(56)62-9-22-31-33(66-36(57)11-3-17(44)27(52)18(45)4-11)34(41(63-22)68-37(58)12-5-19(46)28(53)20(47)6-12)67-38(59)13-7-21(48)29(54)32-25(13)24(30(55)40(61)65-32)14(8-23(49)50)39(60)64-31/h1-7,14,22,24,30-31,33-34,41-48,51-55H,8-9H2,(H,49,50)/t14-,22?,24-,30+,31+,33+,34?,41-/m0/s1",
    "InChI=1S/C29H36O15/c1-13-22(36)    23(37)24(38)29(41-13)44-27-25(39)28(40-9-8-15-3-6-17(32)19(34)11-15)42-20(12-30)26(27)43-21(35)7-4-14-2-5-16(31)18(33)10-14/h2-7,10-11,13,20,22-34,36-39H,8-9,12H2,1H3/b7-4+/t13?,20?,22-,23?,24-,25?,26+,27+,28+,29-/m0/s1",
    "InChI=1S/C15H16O5/c1-6-3-9(17)12-7(2)15(19)20-14(12)13-8(5-16)4-10(18)11(6)13/h4,9,12-14,16-17H,2-3,5H2,1H3/t9-,12+,13-,14-/m1/s1",
    "InChI=1S/C20H30O4/c1-12-6-7-13-15(21)16-19(4,24-16)9-8-14-18(3,23-14)11-10-17(12,2)20(13,5)22/h7,12,14,16,22H,6,8-11H2,1-5H3",
    "InChI=1S/C28H48O/c1-18(2)19(3)7-8-20(4)24-11-12-25-23-10-9-21-17-22(29)13-15-27(21,5)26(23)14-16-28(24,25)6/h9,18-20,22-26,29H,7-8,10-17H2,1-6H3/t19-,20-,22+,23+,24-,25+,26+,27?,28?/m1/s1",
    "InChI=1S/C27H31NO5/c1-15-5-10-19-16(2)13-22(20(4-3-11-29)21(19)12-15)25(31)24-26(32)23(14-28-27(24)33)17-6-8-18(30)9-7-17/h3-4,6-9,13-15,19-22,29-30H,5,10-12H2,1-2H3,(H2,28,32,33)",
    "InChI=1S/C27H34O8/c1-23(2)17(10-18(28)32-5)25(4)16-6-8-24(3)21(14-7-9-33-13-14)34-19(29)12-27(24,31)26(16)11-15(20(25)30)22(23)35-26/h7,9,13,15-17,21-22,31H,6,8,10-12H2,1-5H3/t15-,16+,17-,21-,22+,24-,25+,26-,27-/m0/s1",
    "InChI=1S/C15H20O4/c1-10(7-13(17)18)5-6-15(19)11(2)8-12(16)9-14(15,3)4/h5-8,19H,9H2,1-4H3,(H,17,18)/b6-5+,10-7?/t15-/m1/s1",
    "InChI=1S/C21H30O2/c1-13(2)14-10-15-16(11-18(14)23-6)21(5)9-7-8-20(3,4)19(21)12-17(15)22/h10-11,13,19H,7-9,12H2,1-6H3/t19-,21+/m0/s1",
    "InChI=1S/C15H22O3/c1-9(2)5-4-6-15(3)11-7-10(14(17)18)8-12(16)13(11)15/h5,7,11-13,16H,4,6,8H2,1-3H3,(H,17,18)",
    "InChI=1S/C21H34N4O6/c1-12-18(28)22-13(2)19(29)24-15(8-5-4-6-10-17(27)14(3)26)21(31)25-11-7-9-16(25)20(30)23-12/h12-16,26H,4-11H2,1-3H3,(H,22,28)(H,23,30)(H,24,29)",
    "InChI=1S/C68H94Cl2N18O18/c1-29(2)49-63(101)87-45(15-11-19-73-87)59(97)85-43(13-9-17-71-85)55(93)75-41(27-105-7)53(91)81-51(31(5)89)61(99)83-47(57(95)79-49)25-67(103)35-21-33(37(69)23-39(35)77-65(67)83)34-22-36-40(24-38(34)70)78-66-68(36,104)26-48-58(96)80-50(30(3)4)64(102)88-46(16-12-20-74-88)60(98)86-44(14-10-18-72-86)56(94)76-42(28-106-8)54(92)82-52(32(6)90)62(100)84(48)66/h21-24,29-32,41-52,65-66,71-74,77-78,89-90,103-104H,9-20,25-28H2,1-8H3,(H,75,93)(H,76,94)(H,79,95)(H,80,96)(H,81,91)(H,82,92)",
    "InChI=1S/C16H20O3/c1-2-3-4-5-6-7-8-9-13-10-11-15(18)16(19)14(13)12-17/h6-12,18-19H,2-5H2,1H3",
    "InChI=1S/C48H76O19/c1-43(2)16-22-21-8-9-26-45(4)12-11-28(46(5,20-51)25(45)10-13-48(26,7)47(21,6)15-14-44(22,3)27(52)17-43)64-42-38(34(58)33(57)36(65-42)39(60)61)67-41-37(32(56)30(54)24(19-50)63-41)66-40-35(59)31(55)29(53)23(18-49)62-40/h8,20,22-38,40-42,49-50,52-59H,9-19H2,1-7H3,(H,60,61)/t22-,23+,24+,25+,26+,27+,28-,29+,30-,31-,32-,33-,34-,35+,36-,37+,38+,40-,41-,42+,44+,45-,46+,47+,48+/m0/s1",
    "InChI=1S/C30H40N6O6/c31-30(32)33-16-4-8-22(19-37)34-27(40)25-9-5-17-36(25)29(42)24(15-12-20-6-2-1-3-7-20)35-28(41)26(39)18-21-10-13-23(38)14-11-21/h1-3,6-7,10-11,13-14,19,22,24-26,38-39H,4-5,8-9,12,15-18H2,(H,34,40)(H,35,41)(H4,31,32,33)/t22?,24-,25+,26-/m1/s1",
    "InChI=1S/C18H23N5O9/c1-28-12-11-7(31-15(12)23-6-22-10-13(19)20-5-21-14(10)23)3-9-18(27,32-11)17(25,26)4-8(30-9)16(24)29-2/h5-9,11-12,15,25-27H,3-4H2,1-2H3,(H2,19,20,21)",
    "InChI=1S/C37H42O13/c1-20-18-27(45-22(3)39)30(46-23(4)40)36(19-44-21(2)38)32(49-34(43)26-16-12-9-13-17-26)29(48-33(42)25-14-10-8-11-15-25)28-31(47-24(5)41)37(20,36)50-35(28,6)7/h8-17,20,27-32H,18-19H2,1-7H3/t20-,27+,28-,29-,30+,31+,32+,36+,37-/m1/s1",
    "InChI=1S/C26H31ClN2O/c1-9-23(3,4)21-20-19-15(12-11-13-16(19)29-21)24(5,6)17-14-18(27)25(7,10-2)22(28-8)26(17,20)30/h9-13,17-18,22,29-30H,1-2,14H2,3-7H3/t17-,18-,22+,25+,26-/m1/s1",
    "InChI=1S/C15H16O5/c1-7-4-9(16)13-11(19-7)6-10-8(14(13)17)5-12(20-10)15(2,3)18/h4,6,12,17-18H,5H2,1-3H3",
    "InChI=1S/C47H34O32/c48-13-1-9(2-14(49)24(13)55)36(61)77-40-33-32-30(19(72-40)8-70-37(62)10-3-15(50)25(56)28(59)21(10)22-11(38(63)73-32)4-16(51)26(57)29(22)60)75-41(65)43-6-20(54)45(67,79-44(43)42(66)76-35-18(53)7-71-47(35,44)69)46(68)34(43)23-12(39(64)74-33)5-17(52)27(58)31(23)78-46/h1-5,18-19,30,32-35,40,48-53,55-60,67-69H,6-8H2",
    "InChI=1S/C28H27NO11/c1-12-7-17(10-19(30)22(12)25(33)29-15(4)26(34)35)39-28(37)24-14(3)8-18(11-21(24)32)40-27(36)23-13(2)6-16(38-5)9-20(23)31/h6-11,15,30-32H,1-5H3,(H,29,33)(H,34,35)",
    "InChI=1S/C33H35ClO11/c1-15(2)7-8-31-24(44-26(38)23-19(35)9-16(3)10-20(23)36)17(11-21(37)25(31)45-31)18-12-29(4)14-30(28(40)43-6)13-22(42-5)33(29,34)32(18,41)27(30)39/h7,9-13,21,24-25,35-37,41H,8,14H2,1-6H3/t21-,24+,25-,29-,30+,31+,32-,33-/m0/s1",
    "InChI=1S/C21H24O7/c1-9(2)11-7-15-12(20(24)26-5)8-16(27-15)17(10(3)4)19-18(23)13(6-14(11)22)21(25)28-19/h6,8,11,14,17-19,22-23H,1,3,7H2,2,4-5H3/b13-6+",
    "InChI=1S/C14H21NO5/c1-15(2)10(14(17)18)6-5-9-7-11(19-3)13(16)12(8-9)20-4/h7-8,10,16H,5-6H2,1-4H3,(H,17,18)",
    "InChI=1S/C28H42O8/c1-8-11-22(31)35-23-17(5)27(7,13-12-16(4)9-2)21-15-19(30)14-20-25(33-10-3)36-26(34-18(6)29)28(20,21)24(23)32/h9,12,14,17,19,21,23-26,30,32H,2,8,10-11,13,15H2,1,3-7H3",
    "InChI=1S/C11H19NO6/c1-3-11(2,5-12)18-10-9(16)8(15)7(14)6(4-13)17-10/h6-10,13-16H,3-4H2,1-2H3/t6-,7-,8+,9-,10+,11?/m1/s1",
    "InChI=1S/C41H30O27/c42-13-1-8(2-14(43)24(13)48)34(54)65-32-30-18-7-62-35(55)9-3-15(44)25(49)28(52)20(9)21-10(4-16(45)26(50)29(21)53)37(57)67-39(63-18)33(32)66-36(56)11-5-17(46)27(51)31-22(11)23-12(38(58)64-30)6-19(47)41(61,68-31)40(23,59)60/h1-6,18,23,30,32-33,35,39,42-46,48-53,55,59-61H,7H2/t18-,23?,30-,32-,33+,35?,39+,41?/m1/s1",
    "InChI=1S/C31H40O15/c1-15-24(36)25(37)26(38)31(43-15)46-29-27(39)30(42-11-10-17-5-8-19(34)21(13-17)41-3)44-22(14-32)28(29)45-23(35)9-6-16-4-7-18(33)20(12-16)40-2/h4-9,12-13,15,22,24-34,36-39H,10-11,14H2,1-3H3/b9-6+/t15-,22+,24-,25+,26+,27+,28+,29+,30+,31-/m0/s1",
    "InChI=1S/C23H33NO4/c1-4-5-6-7-8-17(2)15-18(3)9-14-22(26)24-21(23(27)28)16-19-10-12-20(25)13-11-19/h9-15,17,21,25H,4-8,16H2,1-3H3,(H,24,26)(H,27,28)",
    "InChI=1S/C27H18O17/c28-2-5(30)20-19(37)24-23(41-20)12-11(27(40)44-24)8(14(32)17(35)16(12)34)7-10-9-6-3(25(38)42-22(9)18(36)15(7)33)1-4(29)13(31)21(6)43-26(10)39/h1,5,19-20,23-24,28-37H,2H2",
    "InChI=1S/C20H34O6/c1-16(2)13(21)7-12-18(4,24)11-6-5-10-15(11)19(25,9-17(10,3)23)8-14(22)20(12,16)26/h10-15,21-26H,5-9H2,1-4H3/t10-,11+,12-,13-,14+,15+,17+,18+,19-,20-/m0/s1",
    "InChI=1S/C8H11N3O6S/c1-4-2-5-3-10(6(4)7(9)12)8(13)11(5)17-18(14,15)16/h2,5-6H,3H2,1H3,(H2,9,12)(H,14,15,16)/t5-,6+/m1/s1",
    "InChI=1S/C19H28BN3O5/c21-8-9-22-14-6-4-12(5-7-14)10-17(24)23-16-11-13-2-1-3-15(19(25)26)18(13)28-20(16)27/h1-3,12,14,16,22,27H,4-11,21H2,(H,23,24)(H,25,26)/t12?,14?,16-/m0/s1",
    "InChI=1S/C20H18F3N4O8P.Na/c1-11(28)35-36(31,32)27(16-4-7-33-24-16)10-13-9-26(20(30)34-13)15-8-14(21)19(18(23)17(15)22)25-5-2-12(29)3-6-25;/h2,4-5,7-8,13H,3,6,9-10H2,1H3,(H,31,32);/q;+1/p-1/t13-;/m1./s1",
    "InChI=1S/C17H26O3/c1-3-5-6-7-10-13-16(19)17(20)14-11-8-9-12-15(18)4-2/h4,15-20H,2-3,5-7,10,13-14H2,1H3/t15-,16-,17-/m1/s1",
    "InChI=1S/C18H24N2O2/c1-19-13-17(21)18(14-7-5-4-6-8-14)20(2)15-9-11-16(22-3)12-10-15/h4-12,17-19,21H,13H2,1-3H3/t17-,18+/m1/s1",
    "InChI=1S/C21H36O5/c1-16(22)14-12-10-8-6-4-3-5-7-9-11-13-15-18-19(20(23)24)17(2)21(25)26-18/h17-19H,3-15H2,1-2H3,(H,23,24)/t17?,18-,19?/m1/s1",
    "InChI=1S/C33H44O4/c1-24(17-15-18-25(2)31(34)26(3)22-23-29-19-12-10-13-20-29)16-11-8-6-7-9-14-21-30-27(4)32(35)28(5)33(36)37-30/h10-21,25-26,31,34-35H,6-9,22-23H2,1-5H3",
    "InChI=1S/C36H42ClN7O7/c1-17(2)23-15-40-24-9-7-6-8-21(24)27(23)22-14-20(10-11-25(22)45)32(47)43-30(28(37)26(46)16-41-36(38)39)34(49)44-13-12-19(5)31(44)33(48)42-29(18(3)4)35(50)51/h6-11,14-15,19,26,28,30-31,45-46H,1,12-13,16H2,2-5H3,(H,42,48)(H,43,47)(H,50,51)(H4,38,39,41)",
    "InChI=1S/C40H61N5O9/c1-6-7-8-9-10-11-30(41)35(48)39(52)45-34(25(4)5)38(51)43-32(22-24(2)3)37(50)42-31(21-16-26-12-17-28(46)18-13-26)36(49)44-33(40(53)54)23-27-14-19-29(47)20-15-27/h12-15,17-20,24-25,30-35,46-48H,6-11,16,21-23,41H2,1-5H3,(H,42,50)(H,43,51)(H,44,49)(H,45,52)(H,53,54)",
    "InChI=1S/C18H33N/c1-3-5-6-7-8-9-10-11-12-13-15-18-16-14-17-19(18)4-2/h9-12,18H,3-8,13-17H2,1-2H3/b10-9+,12-11+/t18-/m0/s1",
    "InChI=1S/C16H14O7/c1-22-15-12(21)5-10(19)14-11(20)6-13(23-16(14)15)7-2-3-8(17)9(18)4-7/h2-5,13,17-19,21H,6H2,1H3",
    "InChI=1S/C10H23FN3O2P/c1-6-13(7-2)10(14(8-3)9-4)12-17(11,15)16-5/h6-9H2,1-5H3",
    "InChI=1S/C17H25NO/c1-2-9-16-10-3-4-11-17(16)19-15-8-7-14-18-12-5-6-13-18/h2-4,10-11H,1,5-9,12-15H2",
    "InChI=1S/FHO3S/c1-5(2,3)4/h(H,2,3,4)/p-1",
    "InChI=1S/C22H27F3O4S/c1-11-6-13-14-8-16(24)15-7-12(26)4-5-19(15,2)21(14,25)17(27)9-20(13,3)22(11,29)18(28)30-10-23/h4-5,7,11,13-14,16-17,27,29H,6,8-10H2,1-3H3/t11-,13+,14+,16+,17+,19+,20+,21+,22+/m1/s1",
    "InChI=1S/C13H16O5/c1-5-7(3)18-4-8-9(5)6(2)11(14)10(12(8)15)13(16)17/h5,7,14-15H,4H2,1-3H3,(H,16,17)",
    "InChI=1S/C5H10O6/c6-1-2(7)3(8)4(9)5(10)11/h2-4,6-9H,1H2,(H,10,11)",
    "InChI=1S/C11H20O/c1-9(2)8-5-6-10(9,3)11(4,12)7-8/h8,12H,5-7H2,1-4H3",
    "InChI=1S/C18H22O8P2/c1-3-17(13-5-9-15(10-6-13)25-27(19,20)21)18(4-2)14-7-11-16(12-8-14)26-28(22,23)24/h5-12H,3-4H2,1-2H3,(H2,19,20,21)(H2,22,23,24)/b18-17+",
    "InChI=1S/C12H22O11/c13-1-3-5(14)8(17)10(19)12(23-3)21-2-4-6(15)7(16)9(18)11(20)22-4/h3-20H,1-2H2/t3-,4-,5-,6-,7+,8+,9-,10-,11?,12-/m1/s1",
    "InChI=1S/C17H21N/c1-15(13-16-9-5-3-6-10-16)18(2)14-17-11-7-4-8-12-17/h3-12,15H,13-14H2,1-2H3",
    "InChI=1S/C14H17N3O2S/c1-11-9-16-7-8-17(11)20(18,19)14-4-2-3-12-10-15-6-5-13(12)14/h2-6,10-11,16H,7-9H2,1H3",
    "InChI=1S/C12H23NO7/c1-6-8(13-11(17)7(15)4-5-14)9(16)10(18-2)12(19-3)20-6/h6-10,12,14-16H,4-5H2,1-3H3,(H,13,17)/t6-,7+,8-,9+,10+,12+/m1/s1",
    "InChI=1S/C18H17ClN2O2/c1-12-10-21-11-17(22)20-16-8-7-14(19)9-15(16)18(21,23-12)13-5-3-2-4-6-13/h2-9,12H,10-11H2,1H3,(H,20,22)",
    "InChI=1S/C56H80O2/c1-42(2)22-14-23-43(3)24-15-25-44(4)26-16-27-45(5)28-17-29-46(6)30-18-31-47(7)32-19-33-48(8)34-20-35-49(9)36-21-37-50(10)40-41-52-51(11)55(57)53-38-12-13-39-54(53)56(52)58/h12-13,22,24,26,28,30,32,34,36,38-40H,14-21,23,25,27,29,31,33,35,37,41H2,1-11H3/b43-24+,44-26+,45-28+,46-30+,47-32+,48-34+,49-36+,50-40+",
    "InChI=1S/C19H22N8O6S2/c1-33-24-12(10-8-35-19(21)22-10)15(29)23-13-16(30)27-14(18(31)32)9(7-34-17(13)27)6-25-3-2-11(20)26(25)4-5-28/h2-3,8,13,17,20,28H,4-7H2,1H3,(H2,21,22)(H,23,29)(H,31,32)/b20-11?,24-12-/t13-,17-/m1/s1",
    "InChI=1S/C19H19NO4/c1-20-6-5-11-8-14-19(24-9-23-14)17-15(11)12(20)7-10-3-4-13(22-2)18(21)16(10)17/h3-4,8,12,21H,5-7,9H2,1-2H3/t12-/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6?/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2-3(8)4(9)5(10)6(11)12-2/h2-11H,1H2/t2-,3-,4-,5+,6?/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2-3(8)4(9)5(10)6(11)12-2/h2-11H,1H2/t2-,3-,4-,5+,6-/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6+/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6-/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6?/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6+/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3+,4+,5-,6-/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2-3(8)4(9)5(10)6(11)12-2/h2-11H,1H2/t2-,3-,4-,5+,6?/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2-3(8)4(9)5(10)6(11)12-2/h2-11H,1H2/t2-,3-,4-,5+,6+/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2",
    "InChI=1S/C9H11N/c10-9-6-8(9)7-4-2-1-3-5-7/h1-5,8-9H,6,10H2",
    "InChI=1S/C15H15NO8/c17-9-10(18)12(13(20)21)23-15(11(9)19)24-14(22)7-5-16-8-4-2-1-3-6(7)8/h1-5,9-12,15-19H,(H,20,21)/t9-,10-,11+,12-,15-/m0/s1",
    "InChI=1S/C9H11N/c10-9-6-8(9)7-4-2-1-3-5-7/h1-5,8-9H,6,10H2/t8-,9+/m0/s1",
    "InChI=1S/C9H11N/c10-9-6-8(9)7-4-2-1-3-5-7/h1-5,8-9H,6,10H2/t8-,9+/m1/s1",
    "InChI=1S/C9H11N/c10-9-6-8(9)7-4-2-1-3-5-7/h1-5,8-9H,6,10H2/t8-,9-/m0/s1",
    "InChI=1S/C19H32O3/c1-3-4-12-15-18(20)16-13-10-8-6-5-7-9-11-14-17-19(21)22-2/h8,10,13,16H,3-7,9,11-12,14-15,17H2,1-2H3/b10-8+,16-13+",
    "InChI=1S/C17H25NO2/c1-11(2)13-9-8-12(3)10-16(13)20-17(19)14-6-4-5-7-15(14)18/h4-7,11-13,16H,8-10,18H2,1-3H3",
    "InChI=1S/C14H16N2O3S/c1-3-19-13(18)11-8(2)15-14(20)16-12(11)9-5-4-6-10(17)7-9/h4-7,12,17H,3H2,1-2H3,(H2,15,16,20)/t12-/m1/s1",
    "InChI=1S/C7H15N2O8P/c8-1-4(10)9-7-6(12)5(11)3(17-7)2-16-18(13,14)15/h3,5-7,11-12H,1-2,8H2,(H,9,10)(H2,13,14,15)/t3-,5-,6-,7?/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3-,4-,5+,6?/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3-,4-,5+,6+/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3-,4-,5+,6-/m0/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3-,4-,5+,6?/m1/s1",
    "InChI=1S/C6H12O6/c7-1-2(8)5-3(9)4(10)6(11)12-5/h2-11H,1H2/t2-,3-,4-,5+,6+/m1/s1",
    "InChI=1S/C9H11N5O3/c1-3(15)6(16)4-2-11-7-5(12-4)8(17)14-9(10)13-7/h3,15H,2H2,1H3,(H4,10,11,13,14,17)/t3-/m0/s1",
    "InChI=1S/C15H22N2O2/c1-2-19-15(18)11-8-9-14(13(16)10-11)17-12-6-4-3-5-7-12/h8-10,12,17H,2-7,16H2,1H3",
    "InChI=1S/C11H10N2O2S/c1-14-7-2-3-9-6(4-7)5-8(11(13)16)10(12)15-9/h2-5,12H,1H3,(H2,13,16)",
    "InChI=1S/C9H6O6.2H2O/c10-7(11)4-2-1-3-5(8(12)13)6(4)9(14)15;;/h1-3H,(H,10,11)(H,12,13)(H,14,15);2*1H2",
];

#[test]
fn test_inchi_parsing() {
    let mut unimplemented_errors: Vec<&'static str> = Vec::new();
    for (i, &inchi_str) in INCHI_TEST.iter().enumerate() {
        match inchi_str.parse::<InChI>() {
            Ok(_) => {}
            Err(Error::UnimplementedFeature(msg)) => {
                unimplemented_errors.push(inchi_str);
                println!("Unimplemented feature for InChI: {inchi_str}: {msg}");
            }
            Err(e) => {
                panic!("{i}) Failed to parse InChI {inchi_str}: {e:?}");
            }
        }
    }
    if !unimplemented_errors.is_empty() {
        panic!(
            "{} InChI strings could not be parsed due to unimplemented features.",
            unimplemented_errors.len()
        );
    }
}
